import{s as a,u as l}from"./index-CkFOaj7m.js";function u(e){if(!e)return null;const t=new Date(e);return isNaN(t)?null:t.toISOString().slice(0,10)}const c={ebay:"ebay",etsy:"etsy",vinted:"vinted",none:"none"};function d(e){const t=String(e||"").toLowerCase();return c[t]||"none"}async function y(e){const{data:t}=await a.auth.getSession(),o=t?.session?.user?.id;if(!o)throw new Error("Not signed in.");const s={user_id:o,title:e.title,vendor:e.vendor||null,department:e.department||null,category:e.category||null,sub_category:e.subcategory||null,brand:e.brand||null,location:e.location||null,sku:e.sku||null,platforms_listed:d(e.platform),purchase_date:u(e.purchase_date),purchase_price:e.purchase_price?Number(e.purchase_price):null,quantity_on_hand:e.quantity?Number(e.quantity):1,notes:e.notes||null},{data:r,error:i}=await a.from("inventory").insert(s).select("*").single();if(i)throw i;if(e.receiptFile)try{const n=await l("inventory",r.id,e.receiptFile);await a.from("inventory").update({receipt_path:n}).eq("id",r.id),r.receipt_path=n}catch(n){console.warn("Inventory receipt upload failed:",n?.message||n)}return r}export{y as addInventoryFull};
